= Examples

ifdef::env-github[]
:tip-caption: :bulb:
:toc-placement: preamble
endif::[]

== JSON Schema

The first step with LDS is to define your JSON Schemas. Here is a simple Person -> Address example. Start by creating a SCHEMA_FOLDER directory.


=== Create Person object

*SCHEMA_FOLDER/person.json*

[source,json,linenums]
----
{
  "$ref": "#/definitions/person",
  "definitions": {
    "person": {
      "type": "object",
      "properties": {
        "name": { <1>
          "type": "string"
        },
        "addresses": { <2>
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "_link_property_addresses": {
          "type": "object",
          "properties": {
            "address": {
              "type": "null"
            }
          }
        }
      }
    }
  },
  "$schema": "http://json-schema.org/draft-04/schema#"
}
----
<1> `name` is of primitive string type
<2> `address` is an array of links to type Address

*PROJECT/schemas/address.json*

[source,json,linenums]
----
{
  "$ref": "#/definitions/address",
  "definitions": {
    "address": {
      "type": "object",
      "properties": {
        "street": {
          "type": "string"
        },
        "city": {
          "type": "string"
        }
      }
    }
  },
  "$schema": "http://json-schema.org/draft-04/schema#"
}
----

== Run

Noow that you have

`docker run -it -v PROJECT/schemas:/schemas -p 9090:9090 lds-memory:latest`

== Create, Overwrite, Read and Delete

=== Create Person

`curl -X PUT -d {"name": "John Doe"} -i http://localhost:9090/data/person/1`

=== Get Person

`curl -i http://localhost:9090/data/person/1` responds with:

[source,json]
----
{
    "name": "John Doe"
}
----


=== Create Address

`curl -X PUT -d {"street": "Doe Street 1", "city": "Cool City"} -i http://localhost:9090/data/address/1`

=== Connect Address to Person

`curl -X PUT -i http://localhost:9090/data/person/1/addresses/address/1`

=== Get Person

`curl -i http://localhost:9090/data/person/1` responds with:

[source,json]
----
{
    "name": "John Doe",
    "addresses": [
        "/address/1"
    ]
}
----

=== Get Address

`curl -i http://localhost:9090/data/address/1` responds with:

[source,json]
----
{
    "street": "Doe Street 1",
    "city": "Cool City"
}
----


== Java Server Bootstrap

[source,java,linenums,options="nowrap"]
----
include::source/Server.java[]
----
